# Recarregar o JSON completo com base na estrutura Elementor
with open(original_json_path, "r", encoding="utf-8") as f:
    data = json.load(f)

# Estrutura básica do HTML completo (sem perder dados)
html_header = """
<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Página Melancia</title>
  <style>
    body { margin: 0; padding: 0; font-family: sans-serif; background: #fff; }
    .elementor-section { margin-bottom: 30px; }
    .elementor-widget-image img { max-width: 100%; height: auto; }
    .elementor-container { max-width: 1140px; margin: auto; padding: 20px; }
  </style>
</head>
<body>
<div class="elementor">
"""

html_footer = """
</div>
</body>
</html>
"""

# Função para traduzir elementos do Elementor para HTML bruto
def render_elementor_elements(elements):
    html = []
    for el in elements:
        widget = el.get("widgetType", "")
        settings = el.get("settings", {})
        el_class = f'elementor-widget-{widget}' if widget else ''

        # Renderiza HTML bruto (bloco personalizado)
        if widget == "html" and "html" in settings:
            html.append(f'<div class="{el_class}">{settings["html"]}</div>')
        # Renderiza textos
        elif widget == "text-editor" and "editor" in settings:
            html.append(f'<div class="{el_class}">{settings["editor"]}</div>')
        # Renderiza imagem
        elif widget == "image":
            image_data = settings.get("image", {})
            img_url = image_data.get("url", "")
            if img_url:
                html.append(f'<div class="{el_class}"><img src="{img_url}" alt="Imagem" /></div>')

        # Renderiza recursivamente os filhos
        if "elements" in el:
            inner_html = render_elementor_elements(el["elements"])
            html.append(inner_html)
    return "\n".join(html)

# Renderizar o conteúdo do JSON completo
rendered_body = render_elementor_elements(data["content"])
full_html = html_header + rendered_body + html_footer

# Salvar HTML completo
output_dir = "/mnt/data/melancia-vercel-completo"
os.makedirs(output_dir, exist_ok=True)
final_path = os.path.join(output_dir, "index.html")
with open(final_path, "w", encoding="utf-8") as f:
    f.write(full_html)

final_path
